(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     35293,        861]
NotebookOptionsPosition[     34488,        839]
NotebookOutlinePosition[     34885,        855]
CellTagsIndexPosition[     34842,        852]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Clear", "[", "orbit", "]"}], ";", 
   RowBox[{"Clear", "[", "eqns", "]"}], ";", 
   RowBox[{"Clear", "[", "soln", "]"}], ";"}], "\n", 
  RowBox[{"(*", 
   RowBox[{"fudge", " ", "an", " ", "orbit"}], "*)"}], "\[IndentingNewLine]", 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tend", " ", "=", " ", "12"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"eartht", "=", "12"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"this", " ", "was", " ", "tend"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"translength", " ", "=", " ", "0.06"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"solart", " ", "=", " ", 
   RowBox[{"eartht", "/", "12"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"t0", "=", 
    RowBox[{"0.34", "eartht"}]}], ";"}], " "}], "\n", 
 RowBox[{
  RowBox[{"t1", "=", 
   RowBox[{"t0", " ", "+", " ", 
    RowBox[{"translength", " ", "eartht"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"t2", "=", " ", 
    RowBox[{"0.4", " ", "eartht"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "time", " ", "when", " ", "white", " ", "line", " ", "starts", " ", "to", 
    " ", "plot"}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"t3", "=", " ", 
    RowBox[{"t2", "+", 
     RowBox[{"3", "solart"}]}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "time", " ", "when", " ", "the", " ", "last", " ", "part", " ", "of", " ", 
    "the", " ", "while", " ", "line", " ", "disappears"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t4", " ", "=", " ", 
   RowBox[{"t0", " ", "+", " ", 
    RowBox[{"4", "solart"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t5", "=", "  ", 
   RowBox[{"t4", "+", " ", 
    RowBox[{"translength", " ", "eartht"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tellipse1", " ", "=", " ", "1.12"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tellipse2", " ", "=", " ", "3.18"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tellipse3", " ", "=", " ", 
   RowBox[{"1.12", " ", "+", " ", 
    RowBox[{"2", "*", "4"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tellipse4", " ", "=", " ", 
    RowBox[{"3.18", "+", " ", 
     RowBox[{"2", "*", "4"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"psptimedilation", " ", "=", " ", "1.14559"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "The", " ", "orbit", " ", "is", " ", "just", " ", "an", " ", "ellipse"}], 
    ",", " ", 
    RowBox[{
    "not", " ", "based", " ", "on", " ", "gravity", " ", "or", " ", "mass", 
     " ", "of", " ", "sun"}], ",", " ", 
    RowBox[{
    "so", " ", "I", " ", "can", " ", "fix", " ", "its", " ", "rate", " ", 
     "around", " ", "the", " ", "ellipse", " ", "to", " ", "make", " ", "the",
      " ", "animation", " ", "loop"}]}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"x0", ",", "y0"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "1"}], "}"}]}], ";", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"v0x", ",", "v0y"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"0.3", ",", "0.3"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eqns", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"x", "[", "0", "]"}], "==", "x0"}], ",", 
     RowBox[{
      RowBox[{"y", "[", "0", "]"}], "==", "y0"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"x", "'"}], "[", "0", "]"}], "==", "v0x"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"y", "'"}], "[", "0", "]"}], "==", "v0y"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"x", "''"}], "[", "t", "]"}], "==", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"x", "[", "t", "]"}]}], "/", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"x", "[", "t", "]"}], "^", "2"}], "+", 
          RowBox[{
           RowBox[{"y", "[", "t", "]"}], "^", "2"}]}], ")"}], "^", 
        "1.5"}]}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"y", "''"}], "[", "t", "]"}], "==", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"y", "[", "t", "]"}]}], "/", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"x", "[", "t", "]"}], "^", "2"}], "+", 
          RowBox[{
           RowBox[{"y", "[", "t", "]"}], "^", "2"}]}], ")"}], "^", 
        "1.5"}]}]}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"soln", "=", 
    RowBox[{"Map", "[", 
     RowBox[{"Head", ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x", "[", "t", "]"}], ",", 
         RowBox[{"y", "[", "t", "]"}]}], "}"}], "/.", " ", 
       RowBox[{"First", "[", 
        RowBox[{"NDSolve", "[", 
         RowBox[{"eqns", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"x", "[", "t", "]"}], ",", 
            RowBox[{"y", "[", "t", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", "0", ",", 
            RowBox[{"tend", "*", "psptimedilation"}]}], "}"}]}], "]"}], 
        "]"}]}]}], "]"}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"earth", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "Pi", " ", 
         RowBox[{"#", "/", "eartht"}]}], "]"}]}], ",", 
      RowBox[{"Sin", "[", 
       RowBox[{"2", " ", "Pi", " ", 
        RowBox[{"#", "/", "eartht"}]}], "]"}]}], "}"}], "&"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"solar", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "Pi", " ", 
         RowBox[{"#", "/", "solart"}]}], "]"}]}], ",", 
      RowBox[{"Sin", "[", 
       RowBox[{"2", " ", "Pi", " ", 
        RowBox[{"#", "/", "solart"}]}], "]"}]}], "}"}], "&"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"psp", "[", "t_", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"soln", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "[", 
      RowBox[{"t", "*", "psptimedilation"}], "]"}], ",", 
     RowBox[{
      RowBox[{"soln", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "[", 
      RowBox[{"t", " ", "*", "psptimedilation"}], "]"}]}], "}"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"bg", "=", 
   RowBox[{"RGBColor", "[", 
    RowBox[{"0.", ",", "0.05", ",", "0.1"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"smoothstep", "[", 
    RowBox[{"t_", ",", "t0_", ",", "t1_"}], "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"tt", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"t", "-", "t0"}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"t1", "-", "t0"}], ")"}]}]}], "}"}], ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"tt", "<", "0"}], ",", "0", ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"tt", ">", "1"}], ",", "1", ",", 
         RowBox[{
          RowBox[{"6", " ", 
           RowBox[{"tt", "^", "5"}]}], "-", 
          RowBox[{"15", " ", 
           RowBox[{"tt", "^", "4"}]}], "+", 
          RowBox[{"10", " ", 
           RowBox[{"tt", "^", "3"}]}]}]}], "]"}]}], "]"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"smoothstepI", "[", 
     RowBox[{"t_", ",", "t0_", ",", "t1_"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"t", "-", "t0"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"t0", "-", "t1"}], ")"}]}], ">", "0"}], ",", "0", ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"t", "-", "t1"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "t0"}], "+", "t1"}], ")"}]}], ">", "0"}], ",", 
        RowBox[{
         RowBox[{"1", "/", "2"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{"t", "-", "t1"}], ")"}]}], "+", "t1", "-", "t0"}], 
          ")"}]}], ",", 
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"t", "-", "t0"}], ")"}], "^", "4"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", 
                RowBox[{"t", "^", "2"}]}], "+", 
               RowBox[{"t0", "^", "2"}], "+", 
               RowBox[{"2", " ", "t", " ", 
                RowBox[{"(", 
                 RowBox[{"t0", "-", 
                  RowBox[{"3", " ", "t1"}]}], ")"}]}], "-", 
               RowBox[{"4", " ", "t0", " ", "t1"}], "+", 
               RowBox[{"5", " ", 
                RowBox[{"t1", "^", "2"}]}]}], ")"}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"2", " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"t0", "-", "t1"}], ")"}], "^", "5"}]}], ")"}]}], 
          ")"}]}]}], "]"}]}], "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"nstars", "=", "30"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"stars", "=", " ", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"nstars", ",", "2"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"starsizes", "=", 
    RowBox[{"RandomReal", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}], ",", "nstars"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"rspiralcar", "[", 
     RowBox[{"t_", ",", " ", "theta_", ",", " ", "a_"}], "]"}], " ", ":=", 
    " ", 
    RowBox[{"FromPolarCoordinates", "[", 
     RowBox[{
      RowBox[{"a", "*", "theta"}], " ", "+", " ", 
      RowBox[{"2", " ", "Pi", " ", "t"}]}], "]"}]}], ";"}], "\n", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"transform", "[", "T_", "]"}], ":=", 
   RowBox[{
    RowBox[{"RotationTransform", "[", 
     RowBox[{
      RowBox[{"2", " ", "Pi", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"smoothstepI", "[", 
          RowBox[{
           RowBox[{"T", "/", "solart"}], ",", "t0", ",", "t1"}], "]"}], "-", 
         RowBox[{"smoothstepI", "[", 
          RowBox[{
           RowBox[{"T", "/", "solart"}], ",", "t4", ",", "t5"}], "]"}]}], 
        ")"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}]}], "]"}], ".", "\[IndentingNewLine]", 
    RowBox[{"ScalingTransform", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"0.2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"smoothstep", "[", 
            RowBox[{
             RowBox[{"T", "/", "solart"}], ",", "t0", ",", "t1"}], "]"}], "-", 
           RowBox[{"smoothstep", "[", 
            RowBox[{
             RowBox[{"T", "/", "solart"}], ",", "t4", ",", "t5"}], "]"}]}], 
          ")"}]}]}], ")"}], " ", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}]}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"daylight", "[", 
    RowBox[{"p_", ",", "r_", ",", "col_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Lighter", "@", "col"}], ",", 
     RowBox[{"Disk", "[", 
      RowBox[{"p", ",", "r"}], "]"}], ",", 
     RowBox[{"Darker", "@", "col"}], ",", 
     RowBox[{"EdgeForm", "[", "]"}], ",", 
     RowBox[{"GeometricTransformation", "[", 
      RowBox[{
       RowBox[{"Disk", "[", 
        RowBox[{"p", ",", "r", ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "Pi"}], "}"}]}], "]"}], ",", 
       RowBox[{"RotationTransform", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], ",", 
           RowBox[{"Normalize", "[", "p", "]"}]}], "}"}], ",", "p"}], "]"}]}],
       "]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pspscale", " ", "=", " ", "0.05"}], ";", 
  RowBox[{"pol", " ", "=", " ", 
   RowBox[{"Polygon", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "1"}], " ", "pspscale"}], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "1.5"}], "pspscale"}], ",", 
        RowBox[{
         RowBox[{"-", "1"}], "pspscale"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"1.5", "pspscale"}], ",", 
        RowBox[{
         RowBox[{"-", "1"}], "pspscale"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"1", "pspscale"}], ",", "0"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"1", "pspscale"}], ",", 
        RowBox[{"2", "pspscale"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "1"}], "pspscale"}], ",", 
        RowBox[{"2", "pspscale"}]}], "}"}]}], "}"}], "]"}]}], ";", 
  RowBox[{
   RowBox[{"pspobj", "[", 
    RowBox[{"pspp_", ",", "col_"}], "]"}], ":=", 
   RowBox[{"GeometricTransformation", "[", 
    RowBox[{"pol", ",", 
     RowBox[{
      RowBox[{"TranslationTransform", "[", "pspp", "]"}], ".", 
      RowBox[{"RotationTransform", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}], ",", 
         RowBox[{"Normalize", "[", "pspp", "]"}]}], "}"}], "]"}]}]}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"frame", "[", "T_", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{"Show", "[", 
     RowBox[{
      RowBox[{"Graphics", "[", 
       RowBox[{
        RowBox[{"{", "}"}], ",", 
        RowBox[{"Background", "->", 
         RowBox[{"RGBColor", "[", 
          RowBox[{"0.", ",", "0.05", ",", "0.1"}], "]"}]}], ",", 
        RowBox[{"PlotRange", "->", "1.8"}]}], "]"}], ",", 
      RowBox[{"ParametricPlot", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"transform", "[", 
          RowBox[{"T", "-", "t"}], "]"}], "[", 
         RowBox[{"psp", "[", 
          RowBox[{"T", "-", "t"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", " ", 
          RowBox[{"Min", "[", 
           RowBox[{"eartht", ",", 
            RowBox[{"Max", "[", 
             RowBox[{"0.001", ",", 
              RowBox[{"Min", "[", 
               RowBox[{
                RowBox[{"T", "-", "t2"}], " ", ",", 
                RowBox[{"2", " ", 
                 RowBox[{"(", 
                  RowBox[{"t3", "-", "T"}], ")"}]}]}], "]"}]}], "]"}]}], 
           "]"}]}], "}"}], ",", 
        RowBox[{"PlotStyle", "->", "White"}]}], "]"}], ",", 
      RowBox[{"ParametricPlot", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"transform", "[", 
          RowBox[{"T", "-", "t"}], "]"}], "[", 
         RowBox[{"psp", "[", 
          RowBox[{"T", "-", "t"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", " ", 
          RowBox[{"Min", "[", 
           RowBox[{"eartht", ",", 
            RowBox[{"Max", "[", 
             RowBox[{"0.001", ",", 
              RowBox[{"Min", "[", 
               RowBox[{
                RowBox[{"T", "-", "tellipse1"}], " ", ",", 
                RowBox[{"2", " ", 
                 RowBox[{"(", 
                  RowBox[{"tellipse2", "-", "T"}], ")"}]}]}], "]"}]}], 
             "]"}]}], "]"}]}], "}"}], ",", 
        RowBox[{"PlotStyle", "->", "White"}]}], "]"}], ",", 
      RowBox[{"ParametricPlot", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"transform", "[", 
          RowBox[{"T", "-", "t"}], "]"}], "[", 
         RowBox[{"psp", "[", 
          RowBox[{"T", "-", "t"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", " ", 
          RowBox[{"Min", "[", 
           RowBox[{"eartht", ",", 
            RowBox[{"Max", "[", 
             RowBox[{"0.001", ",", 
              RowBox[{"Min", "[", 
               RowBox[{
                RowBox[{"T", "-", "tellipse3"}], " ", ",", 
                RowBox[{"2", " ", 
                 RowBox[{"(", 
                  RowBox[{"tellipse4", "-", "T"}], ")"}]}]}], "]"}]}], 
             "]"}]}], "]"}]}], "}"}], ",", 
        RowBox[{"PlotStyle", "->", "White"}]}], "]"}], ",", 
      RowBox[{"ParametricPlot", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"transform", "[", "T", "]"}], "[", 
         RowBox[{
          RowBox[{"RotationTransform", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "2"}], " ", "Pi", " ", 
             RowBox[{"T", "/", "solart"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}]}], "]"}], "[", 
          RowBox[{"2", "*", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"t", " ", 
              RowBox[{"Cos", "[", "t", "]"}]}], ",", " ", 
             RowBox[{"t", " ", 
              RowBox[{"Sin", "[", "t", "]"}]}]}], "}"}]}], "]"}], "]"}], ",", 
        " ", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", "Pi"}], "}"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", "White"}]}], "]"}], ",", 
      RowBox[{"ParametricPlot", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"transform", "[", "T", "]"}], "[", 
         RowBox[{
          RowBox[{"RotationTransform", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", "Pi", " ", 
              RowBox[{"T", "/", "solart"}]}], "+", " ", "Pi"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}]}], "]"}], "[", 
          RowBox[{"2", "*", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"t", " ", 
              RowBox[{"Cos", "[", "t", "]"}]}], ",", " ", 
             RowBox[{"t", " ", 
              RowBox[{"Sin", "[", "t", "]"}]}]}], "}"}]}], "]"}], "]"}], ",", 
        " ", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", "Pi"}], "}"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", "White"}]}], "]"}], ",", 
      RowBox[{"Graphics", "[", 
       RowBox[{"GeometricTransformation", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"White", ",", 
           RowBox[{"{", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"ColorData", "[", "\"\<StarryNightColors\>\"", "]"}],
                  "[", 
                 RowBox[{"starsizes", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
                RowBox[{"AbsolutePointSize", "[", 
                 RowBox[{"1", "+", 
                  RowBox[{"2", " ", 
                   RowBox[{"starsizes", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}], ",", 
                RowBox[{"Point", "[", 
                 RowBox[{"stars", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "nstars"}], "}"}]}], "]"}], "}"}], ",", 
           RowBox[{"EdgeForm", "[", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"AbsoluteThickness", "[", "2", "]"}], ",", "bg"}], 
             "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"RGBColor", "[", 
              RowBox[{"1", ",", 
               RowBox[{"192", "/", "255"}], ",", "0"}], "]"}], ",", 
             RowBox[{"Disk", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "0"}], "}"}], ",", "0.13"}], "]"}]}], "}"}],
            ",", 
           RowBox[{"{", 
            RowBox[{"daylight", "[", 
             RowBox[{
              RowBox[{"earth", "[", "T", "]"}], ",", "0.06", ",", 
              RowBox[{"RGBColor", "[", 
               RowBox[{"0.17", ",", "0.59", ",", "1."}], "]"}]}], "]"}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"pspobj", "[", 
             RowBox[{
              RowBox[{"psp", "[", "T", "]"}], ",", 
              RowBox[{"RGBColor", "[", 
               RowBox[{"1.", ",", "0.8", ",", "0.65"}], "]"}]}], "]"}], 
            "}"}]}], "}"}], ",", 
         RowBox[{"transform", "[", "T", "]"}]}], "]"}], "]"}]}], "]"}], 
    ")"}]}], ";"}], "\n", 
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"frame", "[", "T", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"T", ",", "0", ",", "tend"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.83214339629327*^9, 3.8321434257856684`*^9}, {
   3.8321434646843834`*^9, 3.8321434833742814`*^9}, {3.8321436234694223`*^9, 
   3.832143642364157*^9}, {3.8321436824943705`*^9, 3.8321437012791934`*^9}, 
   3.8321437512645283`*^9, {3.8321438087996244`*^9, 3.8321438119642725`*^9}, {
   3.8321438496740894`*^9, 3.8321439236842575`*^9}, {3.8321439873344917`*^9, 
   3.8321439876942077`*^9}, {3.8321441509194045`*^9, 3.832144168569359*^9}, {
   3.832144216259587*^9, 3.832144216704492*^9}, {3.8321442512493906`*^9, 
   3.8321444005940685`*^9}, {3.8321445115856752`*^9, 3.832144556594567*^9}, {
   3.8321445906342506`*^9, 3.8321445910045652`*^9}, {3.832144680814665*^9, 
   3.832144681964171*^9}, {3.8321448621393747`*^9, 3.8321448793331304`*^9}, {
   3.832144913244311*^9, 3.832144965074437*^9}, {3.8321449983344793`*^9, 
   3.832145004489603*^9}, {3.832145048809331*^9, 3.8321450521643496`*^9}, 
   3.8321450898616705`*^9, {3.8321451211738157`*^9, 3.832145227784339*^9}, {
   3.832145284094385*^9, 3.8321452900543656`*^9}, {3.8321491192481575`*^9, 
   3.832149193889719*^9}, {3.8321492292386007`*^9, 3.8321493030437284`*^9}, {
   3.832149384461866*^9, 3.832149400130415*^9}, {3.832149432806307*^9, 
   3.8321494492535925`*^9}, 3.8321494880534725`*^9, {3.832149578818527*^9, 
   3.8321495813483095`*^9}, {3.8321496643740034`*^9, 3.832149664503162*^9}, {
   3.832149732242676*^9, 3.832149741499814*^9}, {3.832149873978412*^9, 
   3.8321498817332478`*^9}, {3.8321499272136183`*^9, 
   3.8321499327149715`*^9}, {3.8321499827532444`*^9, 3.832150016235379*^9}, {
   3.8321500995963364`*^9, 3.832150101545144*^9}, {3.8321501355340457`*^9, 
   3.8321501597636213`*^9}, {3.8321502722331085`*^9, 3.832150345638235*^9}, 
   3.832150399124543*^9, {3.8321504306825204`*^9, 3.832150430841716*^9}, {
   3.832150464682022*^9, 3.8321504682436657`*^9}, {3.8321505308291426`*^9, 
   3.832150533063348*^9}, {3.832150570490246*^9, 3.8321506027874517`*^9}, {
   3.8321506360425463`*^9, 3.832150661023368*^9}, {3.832150695196991*^9, 
   3.83215069923704*^9}, {3.83215078561366*^9, 3.8321508258732343`*^9}, {
   3.8321508626783905`*^9, 3.832150888243552*^9}, {3.8321509201337748`*^9, 
   3.8321509206935363`*^9}, {3.8321509835383763`*^9, 3.832151000912204*^9}, {
   3.832151146028651*^9, 3.832151223453614*^9}, {3.8321512573232527`*^9, 
   3.832151260033627*^9}, {3.832151301453579*^9, 3.832151301679764*^9}, {
   3.8321513717666593`*^9, 3.832151375653469*^9}, {3.832151473658479*^9, 
   3.83215151787351*^9}, {3.8321515874037404`*^9, 3.832151604705452*^9}, {
   3.8321517217851596`*^9, 3.832151722722271*^9}, {3.832151753353671*^9, 
   3.832151753861268*^9}, {3.8321517854335966`*^9, 3.832151852163686*^9}, {
   3.83215189191856*^9, 3.8321518932244406`*^9}, {3.832151925413643*^9, 
   3.8321519304734287`*^9}, {3.832152084568717*^9, 3.8321520853335085`*^9}, {
   3.8321521219984016`*^9, 3.83215212235039*^9}, {3.8321521556847415`*^9, 
   3.832152158508521*^9}, {3.8321522166138697`*^9, 3.832152220678517*^9}, {
   3.8321526257557*^9, 3.832152947253761*^9}, {3.83215300740331*^9, 
   3.8321530164135246`*^9}, 3.8321532777434797`*^9, {3.8321536936723356`*^9, 
   3.832153714003818*^9}, {3.8321541275584073`*^9, 3.8321541519033146`*^9}, {
   3.8321542744686813`*^9, 3.8321542801636972`*^9}, {3.8321544120343513`*^9, 
   3.83215441428976*^9}, {3.8321545644233513`*^9, 3.832154566393371*^9}, {
   3.832155196458781*^9, 3.832155215758657*^9}, {3.8321552934287176`*^9, 
   3.832155324653984*^9}, {3.8321554495437613`*^9, 3.8321554972234697`*^9}, {
   3.832155713533578*^9, 3.832155742813877*^9}, {3.8321558668733845`*^9, 
   3.832155868773836*^9}, {3.8321559078635616`*^9, 3.832155962493777*^9}, {
   3.832156006320607*^9, 3.832156035560442*^9}, {3.832156114558481*^9, 
   3.8321561285935383`*^9}, {3.83215616711339*^9, 3.8321561692485013`*^9}, {
   3.832156245348587*^9, 3.832156252963809*^9}, 3.8321563912736506`*^9, {
   3.8321564213938537`*^9, 3.8321564218935156`*^9}, {3.8321564845836935`*^9, 
   3.8321564862336664`*^9}, {3.832156525718651*^9, 3.832156565083455*^9}, 
   3.8321565967591863`*^9, {3.832156628805833*^9, 3.832156673418608*^9}, {
   3.8321568319185605`*^9, 3.832156832358547*^9}, {3.8321569029737396`*^9, 
   3.8321569127585993`*^9}, {3.8321570343589525`*^9, 3.832157034673774*^9}, 
   3.8321571131028457`*^9, {3.8321571481435995`*^9, 3.832157159788895*^9}, {
   3.8321572052337575`*^9, 3.8321572054037886`*^9}, {3.832157416973744*^9, 
   3.83215741787886*^9}, {3.8321575222939444`*^9, 3.8321575272540603`*^9}, {
   3.832157560153606*^9, 3.8321575721486864`*^9}, {3.832157653023808*^9, 
   3.832157668883611*^9}, {3.8321577083635955`*^9, 3.8321577445484843`*^9}, {
   3.8321582445585284`*^9, 3.8321582691538363`*^9}, {3.8321583903550344`*^9, 
   3.8321584097730837`*^9}, {3.832158477184188*^9, 3.8321584815287094`*^9}, {
   3.8321587595039873`*^9, 3.832158760368551*^9}, {3.832158824294144*^9, 
   3.832158929363991*^9}, {3.8321589733637705`*^9, 3.832159027358881*^9}, {
   3.8321590853787403`*^9, 3.832159112573723*^9}, {3.8321591514389744`*^9, 
   3.832159217073555*^9}, {3.8321611230475574`*^9, 3.832161160268344*^9}, {
   3.832161253855109*^9, 3.832161290647484*^9}, {3.8322190502205114`*^9, 
   3.832219071931116*^9}, {3.832219153693636*^9, 3.8322191876389155`*^9}, {
   3.832219267103421*^9, 3.8322193005162115`*^9}, {3.8322269875391693`*^9, 
   3.8322270142991185`*^9}, {3.8322271115508623`*^9, 3.832227189739756*^9}, {
   3.8322272490392284`*^9, 3.8322272711444864`*^9}, {3.832227441000426*^9, 
   3.832227492679707*^9}, {3.8322279460304813`*^9, 3.832227948949597*^9}, {
   3.83222799167969*^9, 3.832228369679707*^9}, {3.832313376806293*^9, 
   3.832313455699701*^9}, {3.8323144533601356`*^9, 3.832314473360244*^9}, {
   3.832314528630295*^9, 3.832314540945321*^9}, 3.832314579420047*^9, {
   3.832315640510783*^9, 3.832315699940507*^9}, {3.832316518859355*^9, 
   3.8323165958527527`*^9}, {3.8323879530180616`*^9, 3.83238795334319*^9}, {
   3.8323915908003454`*^9, 3.8323916026966176`*^9}, {3.8323921510143256`*^9, 
   3.83239215124751*^9}, {3.832494756561296*^9, 3.832494759156512*^9}, {
   3.8324963932682066`*^9, 3.8324963939409337`*^9}, {3.8324964345308104`*^9, 
   3.8324965104797983`*^9}, {3.8324966937231054`*^9, 
   3.8324967037296734`*^9}, {3.8324967355939026`*^9, 
   3.8324967508791027`*^9}, {3.8324968963925853`*^9, 3.83249692495607*^9}, {
   3.832496961010826*^9, 3.8324969954674354`*^9}, {3.8324975172895355`*^9, 
   3.832497600859207*^9}, {3.832497649162259*^9, 3.8324976590705423`*^9}, {
   3.8324976927000046`*^9, 3.832497774351676*^9}, {3.832497818424758*^9, 
   3.8324978696241956`*^9}, {3.832497913787136*^9, 3.832497925693691*^9}, {
   3.83249796262679*^9, 3.8324979691928625`*^9}, {3.8324980649850545`*^9, 
   3.832498071233527*^9}, {3.8324981402346725`*^9, 3.8324981480543003`*^9}, {
   3.8324982023668313`*^9, 3.8324982505610743`*^9}, {3.8324983239807806`*^9, 
   3.83249833900533*^9}, {3.832498396164999*^9, 3.832498404803258*^9}, {
   3.832498528276908*^9, 3.8324985376268773`*^9}, {3.8324986084082756`*^9, 
   3.832498627190069*^9}, {3.8324986625518436`*^9, 3.832498707903716*^9}, 
   3.832498752088149*^9, {3.832498798743947*^9, 3.8324988526993136`*^9}, 
   3.832498891961586*^9, {3.8324989324506507`*^9, 3.8324989423823037`*^9}, {
   3.8324992527008657`*^9, 3.8324992537707143`*^9}, {3.8325018844795475`*^9, 
   3.8325018863923798`*^9}},
 CellLabel->
  "In[1260]:=",ExpressionUUID->"b9abe319-aabc-42d9-9196-bc3788d1bfaf"],

Cell[BoxData["1.14559`"], "Output",
 CellChangeTimes->{{3.8322281970689974`*^9, 3.832228223359498*^9}, 
   3.832314476609993*^9, 3.8323145446202683`*^9, 3.832314937650316*^9, 
   3.8323156700107355`*^9, 3.8323157009304595`*^9, {3.832316561934697*^9, 
   3.832316596564263*^9}, 3.8323879546018257`*^9, 3.832391604647899*^9, 
   3.8324947650911665`*^9, {3.8324964685670652`*^9, 3.8324964968951283`*^9}, 
   3.832496558257843*^9, 3.832496705709564*^9, {3.832496739436514*^9, 
   3.8324967517150526`*^9}, {3.8324969681626024`*^9, 3.8324969973843355`*^9}, 
   3.8324976031133184`*^9, 3.832497660235928*^9, 3.832497722941622*^9, 
   3.83249777504379*^9, 3.8324979317324033`*^9, 3.8324979777590685`*^9, 
   3.832498071784937*^9, 3.8324981485509434`*^9, {3.8324982323017325`*^9, 
   3.832498251253224*^9}, 3.8324983396741495`*^9, 3.8324984055769644`*^9, {
   3.832498529200388*^9, 3.832498539445675*^9}, 3.8324986103776045`*^9, {
   3.8324986986256685`*^9, 3.8324987130274773`*^9}, 3.8324987560026445`*^9, {
   3.832498804004427*^9, 3.832498810994458*^9}, {3.8324988449805093`*^9, 
   3.832498856597169*^9}, {3.832498933171111*^9, 3.832498943973901*^9}, 
   3.832499254645509*^9, 3.832502071409954*^9},
 CellLabel->
  "Out[1275]=",ExpressionUUID->"f9cbf8ac-cbf2-457a-b782-68488202bd36"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`T$$ = 0, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`T$$], 0, 12}}, Typeset`size$$ = {360., {178., 182.}}, 
    Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = True}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`T$$ = 0}, 
      "ControllerVariables" :> {}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> $CellContext`frame[$CellContext`T$$], 
      "Specifications" :> {{$CellContext`T$$, 0, 12}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{413., {227., 232.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.8322281970689974`*^9, 3.832228223359498*^9}, 
   3.832314476609993*^9, 3.8323145446202683`*^9, 3.832314937650316*^9, 
   3.8323156700107355`*^9, 3.8323157009304595`*^9, {3.832316561934697*^9, 
   3.832316596564263*^9}, 3.8323879546018257`*^9, 3.832391604647899*^9, 
   3.8324947650911665`*^9, {3.8324964685670652`*^9, 3.8324964968951283`*^9}, 
   3.832496558257843*^9, 3.832496705709564*^9, {3.832496739436514*^9, 
   3.8324967517150526`*^9}, {3.8324969681626024`*^9, 3.8324969973843355`*^9}, 
   3.8324976031133184`*^9, 3.832497660235928*^9, 3.832497722941622*^9, 
   3.83249777504379*^9, 3.8324979317324033`*^9, 3.8324979777590685`*^9, 
   3.832498071784937*^9, 3.8324981485509434`*^9, {3.8324982323017325`*^9, 
   3.832498251253224*^9}, 3.8324983396741495`*^9, 3.8324984055769644`*^9, {
   3.832498529200388*^9, 3.832498539445675*^9}, 3.8324986103776045`*^9, {
   3.8324986986256685`*^9, 3.8324987130274773`*^9}, 3.8324987560026445`*^9, {
   3.832498804004427*^9, 3.832498810994458*^9}, {3.8324988449805093`*^9, 
   3.832498856597169*^9}, {3.832498933171111*^9, 3.832498943973901*^9}, 
   3.832499254645509*^9, 3.8325020715036807`*^9},
 CellLabel->
  "Out[1293]=",ExpressionUUID->"0f90a231-c98e-4d49-ba46-0a583807ff7b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"anim", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"frame", "[", "T", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"T", ",", "0", ",", "tend", ",", "0.05"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{"\"\<psp_corotation.gif\>\"", ",", " ", "anim", ",", " ", 
   RowBox[{"\"\<DisplayDurations\>\"", "->", " ", "0.1"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.832159328614523*^9, 3.8321593300421453`*^9}, {
   3.832159397605792*^9, 3.8321593987642403`*^9}, {3.832159572092105*^9, 
   3.8321595736440973`*^9}, {3.8321598240828*^9, 3.832159833324833*^9}, 
   3.8321600062343564`*^9, {3.8321600724319324`*^9, 3.832160075392745*^9}, {
   3.832160332214038*^9, 3.832160339434441*^9}, {3.8321605997576475`*^9, 
   3.832160603180087*^9}, {3.83250100080394*^9, 3.8325010087428217`*^9}, {
   3.8325014246131334`*^9, 3.832501427750893*^9}, {3.8325017848832664`*^9, 
   3.83250178593361*^9}, {3.832502067036461*^9, 3.8325020680495567`*^9}, {
   3.832502361690915*^9, 3.8325023661868916`*^9}},
 CellLabel->
  "In[1296]:=",ExpressionUUID->"4ded69ec-4a06-4df1-a07d-ff175c65c37c"],

Cell[BoxData["\<\"psp_corotation.gif\"\>"], "Output",
 CellChangeTimes->{3.8321602593540387`*^9, 3.832160310299945*^9, 
  3.832160377775155*^9, 3.8321606477638073`*^9, 3.832161445317504*^9, 
  3.832219375519376*^9, 3.8322273561893835`*^9, 3.832315888680567*^9, 
  3.832317020007867*^9, 3.832392041443465*^9, 3.8324952150093193`*^9, 
  3.8324957226083393`*^9, 3.8324991959126825`*^9, 3.832499536810791*^9, 
  3.8325012793020144`*^9, 3.832501676629439*^9, 3.8325020403328385`*^9, 
  3.8325023246202493`*^9, 3.8325028464719934`*^9},
 CellLabel->
  "Out[1297]=",ExpressionUUID->"c8e2f75f-84ed-4f3e-97f9-d6203e67440d"]
}, Open  ]]
},
WindowSize->{1904, 1101},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"12.3 for Microsoft Windows (64-bit) (May 11, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"69b0af77-440c-462a-abe6-e4c3618c621a"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 28100, 706, 1070, "Input",ExpressionUUID->"b9abe319-aabc-42d9-9196-bc3788d1bfaf"],
Cell[28683, 730, 1278, 18, 33, "Output",ExpressionUUID->"f9cbf8ac-cbf2-457a-b782-68488202bd36"],
Cell[29964, 750, 2684, 48, 501, "Output",ExpressionUUID->"0f90a231-c98e-4d49-ba46-0a583807ff7b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32685, 803, 1171, 22, 50, "Input",ExpressionUUID->"4ded69ec-4a06-4df1-a07d-ff175c65c37c"],
Cell[33859, 827, 613, 9, 33, "Output",ExpressionUUID->"c8e2f75f-84ed-4f3e-97f9-d6203e67440d"]
}, Open  ]]
}
]
*)

